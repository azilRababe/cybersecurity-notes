## oledump.py Explained

**oledump.py** is a Python tool used to analyze **OLE2 files**, also called **Compound File Binary Format**. These files can contain multiple embedded objects like documents, macros, images, or executables.

OLE = Object Linking and Embedding
Used heavily by Microsoft Office files like Word and Excel

This makes oledump.py very useful for:

- Malware analysis
- Macro detection
- Forensics
- Phishing document investigation

---

## Basic Usage

```
oledump.py <file>
```

This lists all **data streams** inside the file.

---

## Detecting Macros

When you see a stream marked with a **capital M**, it means:

- That stream contains a **macro**
- High malware risk

Example:

```
4: M ...
```

---

## Extracting a Specific Stream

```
oledump.py <file> -s 4
```

- `-s` means select
- `4` is the stream number

This lets you focus only on the suspicious stream instead of the whole file.

---

## Decompressing VBA Macros

Macros are often compressed or obfuscated.

```
oledump.py <file> -s 4 --vbadecompress
```

This:

- Automatically decompresses VBA code
- Makes it readable
- Helps spot malicious logic like downloads, execution, or persistence

---

## Static vs Dynamic Analysis Context

oledump.py is **static analysis**

- No execution
- Safe
- Inspect contents

Next step is **dynamic analysis**

- Observe behavior
- Network connections
- Payload downloads

That is where **INetSim** comes in.

---

## INetSim Overview

**INetSim = Internet Services Simulation Suite**

It simulates internet services so malware thinks it is online.

Instead of reaching real attacker infrastructure:

- It connects to your fake server
- You safely observe behavior

Perfect for:

- Network activity analysis
- Payload download simulation
- C2 behavior observation

---

## Lab Setup Summary

You use **two machines**:

1. REMnux VM running INetSim
2. AttackBox acting as infected machine

---

## INetSim Configuration Steps

### 1. Get REMnux IP

```
ifconfig
```

Example:

```
10.66.173.65
```

---

### 2. Edit INetSim Config

```
sudo nano /etc/inetsim/inetsim.conf
```

Find:

```
#dns_default_ip 0.0.0.0
```

Change to:

```
dns_default_ip 10.66.173.65
```

Save and exit.

---

### 3. Verify Configuration

```
cat /etc/inetsim/inetsim.conf | grep dns_default_ip
```

---

### 4. Start INetSim

```
sudo inetsim
```

Look for:

```
Simulation running
```

Ignore service errors like http_80_tcp failed.

---

## Testing from AttackBox

### Access INetSim Homepage

In browser:

```
https://10.66.173.65
```

Ignore certificate warning and continue.

You should see the INetSim landing page.

---

## Simulating Malware Download Behavior

Malware often downloads a second payload.

Use CLI to simulate realism.

```
sudo wget https://10.66.173.65/second_payload.zip --no-check-certificate
```

Try another:

```
sudo wget https://10.66.173.65/second_payload.ps1 --no-check-certificate
```

These files are:

- Fake
- Harmless
- Generated by INetSim

Opening them redirects back to INetSim.

---

## What This Demonstrates

You simulated:

- Malware contacting a server
- Downloading secondary payloads
- No real internet access
- No real malware risk

Exactly how real malware behaves.

---

## Connection Reports

When INetSim stops, it generates reports automatically.

Location:

```
/var/log/inetsim/report/
```

View report:

```
sudo cat /var/log/inetsim/report/report.xxxx.txt
```

This shows:

- Connection attempts
- Requested URLs
- Downloaded resources
- Timestamps

Critical for forensic analysis.

---

## One Shot Memory Summary

- oledump.py = static macro analysis
- Capital M = macro detected
- -s = select stream
- --vbadecompress = readable VBA
- INetSim = fake internet
- REMnux hosts services
- AttackBox simulates victim
- Downloads are fake
- Reports show malware behavior
